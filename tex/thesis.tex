
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% LaTeX-Rahmen fuer das Erstellen von Masterarbeiten
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% allgemeine Einstellungen
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% !TeX spellcheck = en_GB
\documentclass[twoside,12pt,a4paper]{report}
%\usepackage{reportpage}
\usepackage[utf8]{inputenc} % yay encoding
\PassOptionsToPackage{hyphens}{url} % URLs bei Bindestrichen trennen
\usepackage{hyperref} % klickbare Fusnnoten und Verweise
\usepackage{url} % URLs
\usepackage{setspace} % flexiblere Abstaende
\usepackage[british]{babel} % Sprachpaket
\usepackage{graphics, graphicx} % Inclucegraphics
\usepackage{color} % Farben fuer Listings
\usepackage{latexsym}
\usepackage[center]{caption} % Caption-Text zentrieren
\usepackage{eurosym} % Euro-Symbol (ja, wirklich)
\usepackage{etoolbox}
\usepackage{subfig} % Figures mit Unterfigures
\usepackage{geometry} % Raender on-demand anpassen
\usepackage{titlesec} % Titelformat von Kapiteln
\usepackage{tipa} % IPA-Lautschrift
\usepackage{todonotes} % \todo-Befehl
\usepackage{amsmath} % Mathekrams
\usepackage{amssymb} % Mathesymbole
\usepackage[shortcuts]{extdash}
\usepackage[listings,skins]{tcolorbox} % Landscape-Listings in Portrait-Seiten
\usepackage{rotating} % Inhalte drehen
% Tabellenkrams
\usepackage{multirow}
\usepackage{tabularx}
\usepackage{arydshln}

\setlength\dashlinedash{0.2pt}
\setlength\dashlinegap{1.5pt}
\setlength\arrayrulewidth{0.3pt}

\usepackage[normalem]{ulem}
\useunder{\uline}{\ul}{}
\usepackage[printonlyused,withpage]{acronym} % Abkuerzungen richtig einfuehren
\usepackage[margin=10pt,font=small,labelfont=bf]{caption}
\author{Jules Kreuer}
\usepackage[titletoc,toc,page, title]{appendix} % Anhang
\renewcommand*\appendixpagename{Appendix} % Titel einer Anhang-Seite
\renewcommand*\appendixtocname{Appendix} % Anhang-Formatierung im Inhaltsverzeichnis

\definecolor{pblue}{rgb}{0.13,0.13,1}
\definecolor{pgreen}{rgb}{0,0.5,0}
\definecolor{pred}{rgb}{0.9,0,0}
\definecolor{pgrey}{rgb}{0.46,0.45,0.48}
\definecolor{codegrey}{rgb}{0.95,0.95,0.95}


% !TeX TXS-program:compile = txs:///pdflatex/[--shell-escape]
\pdfsuppresswarningpagegroup=1

\usepackage{minted}
\renewcommand{\lstlistingname}{Code} % Caption einzelner Codesnippets
\renewcommand{\lstlistlistingname}{Codeverzeichnis} % Ueberschrift der List of Listings

% Argmin<
\DeclareMathOperator*{\argmin}{argmin}

%Bulletpoints itemize
\renewcommand{\labelitemii}{\textbullet}


% Abstand vor/nach Blockquotes
\expandafter\def\expandafter\quote\expandafter{\quote\onehalfspacing}

% Titelformat in "Kapitel X: Titel" ändern
\titleformat{\chapter}
{\normalfont\LARGE\bfseries}{Chapter \thechapter:}{0.3em}{}
\titlespacing*{\chapter}{0pt}{3.5ex plus 1ex minus .2ex}{2.3ex plus .2ex}

\textwidth 15cm
\textheight 23cm
\topmargin 0.0cm
\evensidemargin 1cm
\oddsidemargin 1cm
\footskip 2cm
\parskip0.5explus0.1exminus0.1ex

% Whitespace! Whitespace everywhere!
\geometry{a4paper,top=25mm, bottom=3cm}
\parindent 0px

%larger tabels
\usepackage{changepage}

% adjust table to page width
\usepackage{adjustbox}

% Kann von Student auch nach pers\"onlichem Geschmack ver\"andert werden.
\pagestyle{headings}

% BibLaTex anstatt BibTeX verwenden
\usepackage[style=alphabetic,backend=biber]{biblatex}
\usepackage[babel]{csquotes}
%\setcitestyle{authoryear, round, citesep={;}, aysep={,}, yysep={;}}
\bibliography{thesis.bib}
%\nocite{*}

\newcommand{\td}[1]{\todo[color=green!40]{#1}}

\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Titelseite
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{titlepage}
    \newgeometry{top=25mm, left=30mm, right=30mm, bottom=30mm}
    \begin{center}
        {\LARGE University of T\"ubingen}\\
        {\large Faculty of Science \\
        Department of Computer Science\\[4cm]}
        {\huge Master Thesis Bioinformatics\\[2cm]}
        {\Large\bf Simulating and estimating the effect of gene transfer on bacterial pangenomes\\[1.5cm]}
        {\large Jules Kreuer}\\[0.5cm]
        01.06.2024\\[3cm]
        {\small\bf Reviewers}\\[0.5cm]
        \parbox{7cm}{\begin{center}{\large Dr. Franz Baumdicker}\\
                (Bioinformatics)\\
                {\footnotesize Institute for Bioinformatics and\\ Medical Informatics\\
                University of T\"ubingen}\end{center}}\hfill\parbox{7cm}{\begin{center}
                {\large Prof. Dr. Daniel Huson}\\
                (Bioinformatics)\\
                {\footnotesize Institute for Bioinformatics and\\ Medical Informatics\\
                University of T\"ubingen}\end{center}
        }
    \end{center}
\end{titlepage}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Titelr"uckseite:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\thispagestyle{empty}
\vspace*{\fill}
\begin{minipage}{11cm}
    \textbf{Kreuer, Jules:}\\
    \emph{Simulating and estimating the effect of gene transfer on
        \\bacterial pangenomes.}\\ Master Thesis Bioinformatics\\
    University of T\"ubingen\\
    Thesis period: 01.12.2023 - 01.06.2024 % BA: 4 Monate, MA: 6 Monate
\end{minipage}
\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\pagenumbering{roman}
\setcounter{page}{1}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Seite I: Zusammenfassug, Danksagung
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section*{Abstract}
Horizontal gene transfer (HGT) plays a significant role in shaping the genetic landscape of bacterial populations.
In contrast to the more common vertical gene transfer, horizontal gene transfer allows the lateral exchange of genes.
To study the impact of HGT on bacterial gene frequency spectra, we have extended existing mutation models within the
open-source software \textit{msprime} by incorporating a gene gain and loss model using the Infinitely Many Genes model approach.
The ancestry and mutation simulation is then extended to support HGT events.
Additionally, the model is adjusted to fix its otherwise random ancestry simulation to specified trees, which is essential for
parameter estimation and fitting the simulation to real data.
We then develop an innovative simulation-based testing framework to determine whether a gene frequency spectrum results from neutral evolution.
Finally, this framework is validated, and real-world parameters are estimated using pangenome data.
The final model, documentation, simulation data and examples are available on GitHub: \href{https://github.com/not-a-feature/pangenome-gene-transfer-simulation/}{github.com/not-a-feature/pangenome-gene-transfer-simulation}

\newpage

\section*{Acknowledgements}
 [print version only]
\vfill
\includegraphics[width=8cm]{figures/xkcd.png}\\
\href{https://xkcd.com/2608/}{xkcd.com/2608/}

\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Inhaltsverzeichnis
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\small\normalsize

\tableofcontents

\renewcommand{\baselinestretch}{1}
\small\normalsize

%\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Abbildungsverzeichnis
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\renewcommand{\baselinestretch}{1.3}
\small\normalsize
\phantomsection
\addcontentsline{toc}{chapter}{List of Figures}
\listoffigures
\vfill
%\pagebreak

\renewcommand{\baselinestretch}{1}
\small\normalsize

%\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Tabellenverzeichnis
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\renewcommand{\baselinestretch}{1.3}
\small\normalsize
\phantomsection
\addcontentsline{toc}{chapter}{List of Tables}
\listoftables

\renewcommand{\baselinestretch}{1}
\small\normalsize

%\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Abk"urzungsverzeichnis
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\addcontentsline{toc}{chapter}{List of Abbreviations}
\chapter*{List of Abbreviations\markboth{LIST OF ABBREVIATIONS}{LIST OF ABBREVIATIONS}}
\input{acronyms.tex}
\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Der Haupttext, ab hier mit arabischer Numerierung
%%% Mit \input{dateiname} werden die Datei ``dateiname' eingebunden
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\normalsize

\renewcommand{\thefootnote}{\arabic{footnote}~} % Geschuetztes Leerzeichen vor Inhalt der Fussnote

\pagenumbering{arabic}
\setcounter{page}{1}

%% Introduction
\input{introduction}
%\cleardoublepage

%%
\input{background}
\cleardoublepage

\input{method}
\cleardoublepage

\input{result}
\cleardoublepage

\input{summary}

\cleardoublepage
% Anhaenge wieder mit roemischer Nummerierung
\pagenumbering{roman}
\setcounter{page}{1}
\addcontentsline{toc}{chapter}{Appendix}
\chapter*{Appendix\markboth{APPENDIX}{APPENDIX}}
\input{appendix}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Bibliographie
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\addcontentsline{toc}{chapter}{Bibliography}
\setlength\bibitemsep{\baselineskip}
%\newgeometry{top=25mm, left=30mm, right=30mm, bottom=30mm}
\printbibliography[]

\newpage
%\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Erklaerung
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\addcontentsline{toc}{chapter}{Selbstständigkeitserklärung}
\thispagestyle{empty}
\section*{Selbständigkeitserklärung}

Hiermit versichere ich, dass ich die vorliegende Masterarbeit selbständig und
nur mit den angegebenen Hilfsmitteln angefertigt habe und dass alle Stellen,
die dem Wortlaut oder dem Sinne nach anderen Werken entnommen sind, durch
Angaben von Quellen als Entlehnung kenntlich gemacht worden sind.
Diese Masterarbeit wurde in gleicher oder ähnlicher Form in keinem anderen
Studiengang als Prüfungsleistung vorgelegt.


\vskip 3cm
\textbf{Ort, Datum}	\hfill \textbf{Unterschrift} \hfill
\pagestyle{empty}
\cleardoublepage
\end{document}

